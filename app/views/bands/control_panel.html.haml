#content-utility.control-panel
  #utility-overview
    #overview-primary
      %h2 
        =@band.name 
        %br
        %strong<
          -if @band.genre_1
            ="#{@band.genre_1.name} /" 
          -if @band.genre_2
            ="#{@band.genre_2.name} /"
          -if @band.genre_3
            ="#{@band.genre_3.name}"
      .stats
        %dl
          %dt Total Fans:
          %dd<
            =@band.total_fans
          %dt Total Shares:
          %dd<
            =@band_total_shares
          %dt New Fans Yesterday:
          %dd<
            =@new_fans_yesterday
          %dt New Shares Yesterday:
          %dd<
            =@new_shares_yesterday
          %dt Date of Formation:
          %dd<
            =@band.created_at.strftime("%m/%d/%Y")
          %dt.worth Total Net Worth:
          %dd.worth<
            ='$'+@band.stocks_sold.to_s
          %dt Public Profile
          %dd<
            =link_to "Public Profile", :controller => 'bands', :band_short_name => @band.short_name, :action => 'show'
          -url_hash ={:controller => 'bands', :action => 'toggle_hidden', :id => @band.id}
          -if @band.hidden
            %dt Public Profile Hidden!
            %dd<
              =link_to 'Publish!', url_hash
          -else
            %dt Profile Published!
            %dd<
              =link_to 'Hide!', url_hash
    #overview-secondary
      =image_tag(@band.path_to_headline_photo(:center_graphic))

  #utility-player
    =render :partial => 'common_partials/audio_player', :locals => {:playlist_url => @band.playlist_url}
    =render :partial => 'common_partials/band_player_playlist', :locals => {:playlist_songs => @band.playlist_songs}  
    
  =render :partial => 'control_panel_tabs'
#content-primary
  .profile-column
    #perks.widget-box
      %h2 Perks
      =link_to 'manage perks',{:controller => 'bands', :action => 'manage_perks', :band_short_name => @band.short_name}, :class => "utility-link"
      =render :partial => 'bands/perks_widget', :locals => {:perks => @perks}
    #top-fans.widget-box
      %h2 Top Fans
      =render :partial => 'bands/top_fans', :locals => {:top_fans => @top_fans, :band => @band}
    
      
  .profile-column
    #bio.widget-box
      %h2 Bio
      =link_to_remote "edit", {  :url => {:controller => 'bands', :action => 'remote_bio_edit', :id => @band.id}}, {:href => edit_band_url(@band), :class => 'utility-edit'}
      #bio-content
        =render :partial => 'bands/bio', :locals => {:band => @band}
     
  .profile-column.last
    #news.widget-box
      %h2 news   
      =link_to_remote 'new', { :url => new_news_entry_url(:band_id => @band.id) }, :class => 'utility-new', :href => new_news_entry_url(:band_id => @band.id)
      #news-entries-content
        =render :partial => 'bands/news_entries', :locals => {:news_entries => @news_entries}
      -unless @news_entries.empty?
        =link_to 'Read more news entries...', {:controller => 'news_entries', :action => 'by_band', :band_short_name => @band.short_name}, {:class => 'read-more'}
      =will_paginate @news_entries, :param_name => 'news_entries_page'
    #concerts.widget-box
      %h2 Concerts 
      =link_to_remote 'new', { :url => new_concert_url(:band_id => @band.id) }, :class => 'utility-new', :href => new_concert_url(:band_id => @band.id)
      #concerts-content
        -if @concerts.empty?
          #no-concerts.no-content No Concerts
        -else
          =render :partial => 'concerts/short_concert_admin', :collection => @concerts, :as => :concert
      =will_paginate @concerts, :param_name => 'concerts_page'
    #budget.widget-box
      %h2 Budget
      =link_to 'manage budget', {:controller => 'bands', :action => 'manage_project', :band_short_name => @band.short_name}, :class => "utility-link"
      #budget-content
        %table{:cellpadding => "0", :cellspacing => "0", :class => "utility-table"}
          %thead
            %tr
              %th.amount Amount
              %th.desc Description
          %tbody
            =render :partial => 'bands/budget_widget', :locals => {:ledger_entries => @ledger_entries}
  .profile-column-wide
    #stage
      %h2 Stage
      #stage_comments_list
      -if @stage_comments.empty?
        #no-stage-comments.no-content
          No Stage Comments Yet
      -else
        =render :partial => 'stage_comments/list_row', :collection => @stage_comments, :as => :stage_comment
        =will_paginate @stage_comments, :param_name => 'stage_comments_page'
